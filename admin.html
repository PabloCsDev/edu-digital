<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Admin — Resultados do Quiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7f9;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #4a6fc0 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .auth-area {
            text-align: right;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .auth-area span {
            margin-right: 15px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        #btnSignIn {
            background-color: #4285f4;
            color: white;
        }
        
        #btnSignIn:hover {
            background-color: #3367d6;
        }
        
        #btnSignOut {
            background-color: #ea4335;
            color: white;
        }
        
        #btnSignOut:hover {
            background-color: #d33426;
        }
        
        .admin-content {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 16px;
            color: #7f8c8d;
            margin-bottom: 10px;
        }
        
        .stat-card .number {
            font-size: 32px;
            font-weight: 700;
            color: #2c3e50;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background-color: #f1f5f9;
            font-weight: 600;
            color: #2c3e50;
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-item {
            display: flex;
            flex-direction: column;
        }
        
        .filter-item label {
            font-size: 14px;
            margin-bottom: 5px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .filter-item select, .filter-item input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            min-width: 150px;
        }
        
        .login-container {
            max-width: 450px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .login-message {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        
        .error {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .success {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        @media (max-width: 768px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .filter-item {
                width: 100%;
            }
            
            .filter-item select, .filter-item input {
                width: 100%;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
        }
        
        .chart-container {
            margin-top: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
        }
        
        .chart-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 992px) {
            .charts-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Verificação de login -->
        <script>
            // Verificar se o usuário está logado
            if (sessionStorage.getItem('isLoggedIn') !== 'true') {
                // Se não estiver logado, redirecionar para a página de login
                window.location.href = 'login.html';
            }
        </script>

        <div class="auth-area">
            <span id="userEmail">Administrador</span>
            <button id="btnSignIn" style="display:none;">Entrar com Google</button>
            <button id="btnSignOut" onclick="logout()">Sair</button>
        </div>

        <header>
            <h1>Resultados — Educação Digital Segura (Admin)</h1>
            <p>Painel administrativo para visualização e análise das respostas do quiz</p>
        </header>

        <div class="stats-cards">
            <div class="stat-card">
                <h3>Total de Respostas</h3>
                <div class="number" id="totalSubmissions">0</div>
            </div>
            <div class="stat-card">
                <h3>Taxa de Completude</h3>
                <div class="number" id="completionRate">0%</div>
            </div>
            <div class="stat-card">
                <h3>Respostas Hoje</h3>
                <div class="number" id="todaySubmissions">0</div>
            </div>
            <div class="stat-card">
                <h3>Média de "Sim"</h3>
                <div class="number" id="averageYes">0%</div>
            </div>
        </div>

        <div class="admin-content">
            <h2>Filtros e Estatísticas</h2>
            
            <div class="filters">
                <div class="filter-item">
                    <label for="dateFilter">Data:</label>
                    <input type="date" id="dateFilter">
                </div>
                <div class="filter-item">
                    <label for="questionFilter">Pergunta:</label>
                    <select id="questionFilter">
                        <option value="all">Todas as perguntas</option>
                        <option value="1">Pergunta 1</option>
                        <option value="2">Pergunta 2</option>
                        <option value="3">Pergunta 3</option>
                        <option value="4">Pergunta 4</option>
                        <option value="5">Pergunta 5</option>
                        <option value="6">Pergunta 6</option>
                        <option value="7">Pergunta 7</option>
                        <option value="8">Pergunta 8</option>
                        <option value="9">Pergunta 9</option>
                        <option value="10">Pergunta 10</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="answerFilter">Resposta:</label>
                    <select id="answerFilter">
                        <option value="all">Todas as respostas</option>
                        <option value="Sim">Sim</option>
                        <option value="Não">Não</option>
                    </select>
                </div>
            </div>

            <div class="charts-row">
                <div class="chart-container">
                    <div class="chart-title">Distribuição de Respostas (Sim/Não)</div>
                    <canvas id="answerChart" height="250"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Respostas por Pergunta</div>
                    <canvas id="questionChart" height="250"></canvas>
                </div>
            </div>

            <h3>Respostas Detalhadas</h3>
            <table id="tableRaw">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>Q1</th>
                        <th>Q2</th>
                        <th>Q3</th>
                        <th>Q4</th>
                        <th>Q5</th>
                        <th>Q6</th>
                        <th>Q7</th>
                        <th>Q8</th>
                        <th>Q9</th>
                        <th>Q10</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Dados serão inseridos aqui via JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Função de logout
        function logout() {
            sessionStorage.removeItem('isLoggedIn');
            window.location.href = 'login.html';
        }

        // Dados de exemplo (substituir com dados reais do Firestore)
        const sampleData = [
            {
                nome: "João Silva",
                email: "joao@email.com",
                pergunta1: "Sim",
                pergunta2: "Não",
                pergunta3: "Sim",
                pergunta4: "Não",
                pergunta5: "Sim",
                pergunta6: "Não",
                pergunta7: "Sim",
                pergunta8: "Não",
                pergunta9: "Sim",
                pergunta10: "Não",
                timestamp: "2023-10-15T14:30:00Z"
            },
            {
                nome: "Maria Santos",
                email: "maria@email.com",
                pergunta1: "Não",
                pergunta2: "Sim",
                pergunta3: "Não",
                pergunta4: "Sim",
                pergunta5: "Não",
                pergunta6: "Sim",
                pergunta7: "Não",
                pergunta8: "Sim",
                pergunta9: "Não",
                pergunta10: "Sim",
                timestamp: "2023-10-16T10:15:00Z"
            },
            {
                nome: "Pedro Oliveira",
                email: "pedro@email.com",
                pergunta1: "Sim",
                pergunta2: "Sim",
                pergunta3: "Não",
                pergunta4: "Não",
                pergunta5: "Sim",
                pergunta6: "Sim",
                pergunta7: "Não",
                pergunta8: "Não",
                pergunta9: "Sim",
                pergunta10: "Sim",
                timestamp: "2023-10-16T16:45:00Z"
            }
        ];

        // Função para formatar a data
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('pt-BR') + ' ' + date.toLocaleTimeString('pt-BR');
        }

        // Função para popular a tabela com dados
        function populateTable(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            data.forEach(submission => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${formatDate(submission.timestamp)}</td>
                    <td>${submission.nome}</td>
                    <td>${submission.email}</td>
                    <td>${submission.pergunta1}</td>
                    <td>${submission.pergunta2}</td>
                    <td>${submission.pergunta3}</td>
                    <td>${submission.pergunta4}</td>
                    <td>${submission.pergunta5}</td>
                    <td>${submission.pergunta6}</td>
                    <td>${submission.pergunta7}</td>
                    <td>${submission.pergunta8}</td>
                    <td>${submission.pergunta9}</td>
                    <td>${submission.pergunta10}</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Atualizar estatísticas
            updateStats(data);
        }

        // Função para atualizar as estatísticas
        function updateStats(data) {
            document.getElementById('totalSubmissions').textContent = data.length;
            
            // Calcular taxa de "Sim"
            let yesCount = 0;
            let totalAnswers = 0;
            
            data.forEach(submission => {
                for (let i = 1; i <= 10; i++) {
                    if (submission[`pergunta${i}`] === 'Sim') {
                        yesCount++;
                    }
                    totalAnswers++;
                }
            });
            
            const yesPercentage = totalAnswers > 0 ? Math.round((yesCount / totalAnswers) * 100) : 0;
            document.getElementById('averageYes').textContent = `${yesPercentage}%`;
            
            // Respostas de hoje (exemplo)
            document.getElementById('todaySubmissions').textContent = data.length > 0 ? Math.floor(data.length / 2) : 0;
            
            // Taxa de completude (exemplo)
            document.getElementById('completionRate').textContent = '100%';
        }

        // Inicializar a página com dados de exemplo
        document.addEventListener('DOMContentLoaded', function() {
            populateTable(sampleData);
            
            // Inicializar gráficos (simulação)
            setTimeout(() => {
                // Simulação de gráficos
                const answerChart = document.getElementById('answerChart');
                const questionChart = document.getElementById('questionChart');
                
                if (answerChart && questionChart) {
                    answerChart.style.backgroundColor = '#f1f5f9';
                    questionChart.style.backgroundColor = '#f1f5f9';
                    
                    const answerCtx = answerChart.getContext('2d');
                    const questionCtx = questionChart.getContext('2d');
                    
                    // Desenhar gráfico simples (simulação)
                    answerCtx.font = '16px Arial';
                    answerCtx.fillStyle = '#2c3e50';
                    answerCtx.fillText('Gráfico de Respostas', 70, 130);
                    
                    questionCtx.font = '16px Arial';
                    questionCtx.fillStyle = '#2c3e50';
                    questionCtx.fillText('Gráfico por Perguntas', 70, 130);
                }
            }, 500);
        });

        // Simular filtros
        document.getElementById('dateFilter').addEventListener('change', function() {
            // Em uma implementação real, isso filtraria os dados
            console.log('Filtrar por data:', this.value);
        });

        document.getElementById('questionFilter').addEventListener('change', function() {
            // Em uma implementação real, isso filtraria os dados
            console.log('Filtrar por pergunta:', this.value);
        });

        document.getElementById('answerFilter').addEventListener('change', function() {
            // Em uma implementação real, isso filtraria os dados
            console.log('Filtrar por resposta:', this.value);
        });
    </script>
</body>
</html>